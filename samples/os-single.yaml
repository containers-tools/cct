- name: os.single.setup
  description: setup single node OS instance
  environment:
    - version: v0.6
    - osdir: /data/src/github.com/openshift/origin
  changes:
    - file:
        - remove: /data
    - git:
        - checkout: /data/src/github.com/openshift/origin http://github.com/openshift/origin $version
    - shell:
        - set_env: OS_VERSION=$version PATH=/usr/local/bin:/usr/bin:/usr/sbin/
        - shell: useradd vagrant
        - shell: groupdel docker || groupadd docker
        - shell: yum -y --disablerepo=\* --enablerepo=rhel-7-server-rpms install yum-utils 
        - shell: yum-config-manager --disable \* > /dev/null
        - shell: yum-config-manager --enable rhel-7-server-rpms
        - shell: yum-config-manager --enable rhel-7-server-extras-rpms
        - shell: yum-config-manager --enable rhel-7-server-optional-rpms
        - shell: /data/src/github.com/openshift/hack/vm-provision-full.sh
        - shell: /data/src/github.com/openshift/hack/install-etcd.sh
        - shell: /data/src/github.com/openshift/hack/build-release.sh
        - shell: /data/src/github.com/openshift/hack/build-images.sh


# for remote usage just copy /data/src/github.com/openshift/origin/_output/local/go/bin/openshift

